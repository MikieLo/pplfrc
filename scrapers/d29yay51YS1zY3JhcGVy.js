"use strict";chrome.runtime.onMessage.addListener(((e,t,n)=>{if("PF_CHANNEL"===e.action)return void n({isLoaded:!0});if("PF_SCRAPE"!==e.action)return;let o;const[a]=window.location.pathname.split("/").filter(Boolean);switch(a){case"ru":o="ru-RU";break;case"en":o="en-US";break;default:o="uk-UA"}const s=new Map([["uk-UA",new Map([["contacts","Контактна інформація"],["email","пошта"],["emailAddress","Ел. пошта"],["phone","Телефон"],["address","Місто"],["experience","Досвід роботи"],["experienceDates",/^з\s(?<startsOnDate>.+)\sпо\s(?<endsOnDate>.+)$/],["currently",/нині/],["education","Освіта"],["educationYearsFull",/^(?<name>.+),\sз\s(?<fromYear>.+)\sпо\s(?<toYear>.+)$/],["educationYears",/^з\s(?<fromYear>.+)\sпо\s(?<toYear>.+)$/],["additionalInfo","Додаткова інформація"],["skills","Знання і навички"],["resumeDownload","Завантажити"],["resumeDownloadPdf","Завантажити PDF"],["resumeDownloadWord","Завантажити у форматі Word"]])],["ru-RU",new Map([["contacts","Контактная информация"],["email","почта"],["emailAddress","Эл. почта"],["phone","Телефон"],["address","Город"],["experience","Опыт работы"],["experienceDates",/^[сc]\s(?<startsOnDate>.+)\sпо\s(?<endsOnDate>.+)$/],["currently",/наст\.\sвремя/],["education","Образование"],["educationYearsFull",/^(?<name>.+),\s[сc]\s(?<fromYear>.+)\sпо\s(?<toYear>.+)$/],["educationYears",/^[сc]\s(?<fromYear>.+)\sпо\s(?<toYear>.+)$/],["additionalInfo","Дополнительная информация"],["skills","Знания и навыки"],["resumeDownload","Скачать"],["resumeDownloadPdf","Скачать PDF"],["resumeDownloadWord","Скачать в формате Word"]])],["en-US",new Map([["contacts","Contact Information"],["email","Email"],["emailAddress","Email address"],["phone","Phone"],["address","City"],["experience","Work experience"],["experienceDates",/^from\s(?<startsOnDate>.+)\sto\s(?<endsOnDate>.+)$/],["currently",/now/],["education","Education"],["educationYearsFull",/^(?<name>.+),\sfrom\s(?<fromYear>.+)\sto\s(?<toYear>.+)$/],["educationYears",/^from\s(?<fromYear>.+)\sto\s(?<toYear>.+)$/],["additionalInfo","Additional information"],["skills","Knowledge and skills"],["resumeDownload","Download"],["resumeDownloadPdf","Download PDF"],["resumeDownloadWord","Download as a Word document"]])]]),i=window.location.pathname.split("/").filter((e=>!!e)).pop(),r=()=>{const e=new URLSearchParams(window.location.search),t=e.get("jobId"),n=e.get("isJobseeker");return t&&n?fetch(`${window.location.origin}/api/v1/ats/recommended/${t}/view/${i}/`,{method:"GET",headers:{accept:"application/json, text/plain, */*",Cookie:document.cookie,"X-Locale":a}}).then((e=>e.json())).then((e=>(e.recommended.resume.skills=e.recommended.resume.profile.skills.map((e=>e.phrase)),{lastJobApplication:{content:e.recommended.resume},candidate:e.recommended}))):fetch(`${window.location.origin}/api/v1/ats/candidate/${i}/view/?withRecommended=false`,{method:"GET",headers:{accept:"application/json, text/plain, */*",Cookie:document.cookie,"X-Locale":a}}).then((e=>e.json()))};try{const e={},t=[],i=[];let l;const c=e=>!e||document.querySelector("#showContacts, #contactMessage")?Promise.resolve([void 0,void 0]):fetch(e,{method:"GET",headers:{Cookie:document.cookie}}).then((e=>{const t=e.headers.get("content-disposition"),{filename:n,filenameutf8:o}=t.match(/filename="?(?<filename>.+?)"?(;\sfilename\*=utf-8''(?<filenameutf8>.+))*$/).groups;return e.blob().then((e=>new Promise((t=>{const a=new FileReader;a.onload=()=>{const e=a.result;t([e,o&&decodeURIComponent(o)||n])},a.readAsDataURL(e)}))))})),d=document.querySelector("div.card");if(d){const a=d.querySelector("h1");e.full_name=a&&a.innerText;const r=d.querySelector("img");e.photo_url=r&&r.src;const m=document.evaluate(`//dt[contains(., '${s.get(o).get("email")}')]/following-sibling::dd[1]`,document).iterateNext();e.email=m&&m.innerText;const u=document.evaluate(`//dt[contains(., '${s.get(o).get("phone")}')]/following-sibling::dd[1]`,document).iterateNext();e.phone_numbers=u?[u.innerText.replace(/[^+\d]/g,"")]:[];const p=document.evaluate(`//dt[contains(., '${s.get(o).get("address")}')]/following-sibling::dd[1]`,document).iterateNext();e.location=p&&p.innerText;const h=d.querySelector("h2:first-of-type");e.position=h&&h.firstChild.data;const g=h&&h.querySelector("span");g&&(e.salary=parseInt(g.innerText.replace(/[^\d]/g,""),10));const f=document.evaluate(`//h2[. = '${s.get(o).get("experience")}']/following-sibling::h2[preceding-sibling::h2[1]/text()='${s.get(o).get("experience")}']`,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE);for(let e=0;e<f.snapshotLength;e+=1){const n=f.snapshotItem(e),a=n.innerText,i=n.nextElementSibling,r=i.firstChild.data.trim().match(s.get(o).get("experienceDates")),{startsOnDate:l,endsOnDate:c}=r.groups,[d,m]=l.split("."),u=`${m}-${d}-01`;let p;if(!s.get(o).get("currently").test(c)){const[e,t]=c.split(".");p=`${t}-${e}-01`}const h=i.querySelector("br").nextSibling.data.trim(),g=h.match(/^(?<company>.*),\s(?<location>.*)$/);let w,x;g?(w=g.groups.company,x=g.groups.location):w=h;const D=n.nextElementSibling.nextElementSibling,b=D&&D.innerText;t.push({title:a,company:w,location:x,startsOn:u,endsOn:p,description:b})}const w=document.evaluate(`//h2[. = '${s.get(o).get("experience")}']/following-sibling::h2[preceding-sibling::h2[1]/text()='${s.get(o).get("education")}']`,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE);for(let e=0;e<w.snapshotLength;e+=1){const t=w.snapshotItem(e),n=t.innerText;if(n){const e=t.nextElementSibling,a=e.firstChild.data.trim().match(/^(?<subject>.*),.*$/);let r;a&&(r=a.groups.subject);const l=e.querySelector("br").nextSibling.data.trim().match(s.get(o).get("educationYearsFull")),{name:c,fromYear:d,toYear:m}=l.groups,u=t.nextElementSibling.nextElementSibling;let p;u&&"P"===u.nodeName&&(p=u.innerText),i.push({school:n,name:c,subject:r,fromYear:d,toYear:m,description:p})}}const x=[];document.querySelectorAll(".label-skill").forEach((e=>{x.push(e.innerText)})),e.skills=x;const D=document.evaluate(`//h2[. = '${s.get(o).get("additionalInfo")}']/following-sibling::p`,document).iterateNext();e.resume_text=D&&D.innerText;const b=document.evaluate(`//a[. = '${s.get(o).get("resumeDownloadPdf")}' or . = '${s.get(o).get("resumeDownloadWord")}']`,document).iterateNext();e.resume_url=b&&b.href,c(l).then((([o,a])=>{e.resume_data=o,e.resume_filename=a,n([e,t,i])})).catch((e=>{n({message:e.message,stack:e.stack})}))}else Promise.all([fetch(`${window.location.origin}/api/v1/state/?bagName=rareCommon`,{method:"GET",headers:{accept:"application/json, text/plain, */*",Cookie:document.cookie,"X-Locale":a}}).then((e=>e.json())),r()]).then((n=>{const o=n[0].data,a=n[1].candidate,s=n[1].lastJobApplication.content;e.full_name=a.fullName||a.firstName,e.email=a.email,e.phone_numbers=a.phone?[a.phone.replace(/[^+\d]/g,"")]:[],e.photo_url=a.photo&&a.photo.path,e.location=(a.regionName||"")+(a.address?`, ${a.address}`:""),e.urls=(a.socialLinks||[]).map((e=>e.href)),e.position=s.name,e.salary=s.salary,s.experiences.forEach((e=>{t.push({title:e.position+(e.activity?`, ${e.activity}`:""),company:e.company,location:e.location,startsOn:e.startDate||void 0,endsOn:e.endDate||void 0,description:e.duty})})),s.educations.forEach((e=>{i.push({school:e.institution,name:o.educationTypes.find((t=>t.id===e.typeId))?.label,subject:e.faculty,fromYear:e.startYear||void 0,toYear:e.endYear||void 0,description:e.details})})),e.skills=s.skills.map((e=>e.name)),e.resume_text=s.additionalInfo;const r=n[1].lastJobApplication.links||s.links;l=r?.downloadLink?`${window.location.origin}${r?.downloadLink}`:void 0})).then((()=>c(l))).then((([o,a])=>{e.resume_data=o,e.resume_filename=a,n([e,t,i])})).catch((e=>{n({message:e.message,stack:e.stack})}));return!0}catch(e){n({message:e.message,stack:e.stack})}}));
//# sourceMappingURL=d29yay51YS1zY3JhcGVy.js.map