"use strict";chrome.runtime.onMessage.addListener(((e,t,r)=>{if("PF_CHANNEL"===e.action)return void r({isLoaded:!0});if("PF_SCRAPE"!==e.action)return;const a=(e,t,r,a)=>{let n;const o=setInterval((()=>{e()&&(clearInterval(o),clearTimeout(n))}),r);n=setTimeout((()=>{clearInterval(o),t()}),a)};let n;const o=document.querySelector(".resume-header-additional__update-date > div").firstChild.data;switch(o){case"Резюме обновлено":n="ru-RU";break;case"Resume updated":n="en-US";break;case"Түйіндеме жаңартылған":n="kk-KZ";break;default:throw new Error(`Cannot determine site locale from <${o}>`)}const c=new Map([["ru-RU",new Map([["currently",/по\sнастоящее\sвремя/],["male","Мужчина"],["female","Женщина"],["monthGenitiveCase",["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"]],["downloadResume","Скачать резюме"],["salaryNet",/на\sруки/]])],["en-US",new Map([["currently",/currently/],["male","Male"],["female","Female"],["monthGenitiveCase",["January","February","March","April","May","June","July","August","September","October","November","December"]],["downloadResume","Save resume"],["salaryNet",/in\shand/]])],["kk-KZ",new Map([["currently",/currently/],["male","Адам"],["female","Әйел"],["monthGenitiveCase",["қаңтарда","ақпанда","наурызда","сәуірде","мамырда","маусымда","шілдеде","тамызда","қыркүйекте","қазанда","қарашада","желтоқсанда"]],["downloadResume","Түйіндемені көшіру"],["salaryNet",/қолында/]])]]);try{const e=document.querySelector(".resume-header-name"),t=document.querySelector(".resume-media__image"),o=document.querySelector('[data-qa="resume-personal-address"]');let s,l;switch(document.querySelector('[data-qa="resume-personal-gender"]').innerText){case c.get(n).get("male"):s="male";break;case c.get(n).get("female"):s="female";break;default:s=void 0}const i=document.querySelector('[data-qa="resume-personal-birthday"]');if(i){const[e,t,r]=i.innerText.split(/\s/),a=c.get(n).get("monthGenitiveCase").findIndex((e=>0===e.localeCompare(t,"ru-RU",{sensitivity:"accent"})));l=`${r}-${`00${a+1}`.slice(-2)}-${e}`}const u=document.querySelector('[data-qa="resume-block-title-position"]');let m,d;const y=document.querySelector('[data-qa="resume-block-salary"]');if(y){m=parseInt(y.innerText.replace(/[^\d]/g,""),10);const e=y.innerText.replace(c.get(n).get("salaryNet"),"").replace(/[\d\s.]/g,"");switch(e){case"₴":d="UAH";break;case"₽":d="RUB";break;case"Br":d="BYN";break;case"so'm":d="UZS";break;case"₸":d="KZT";break;case"сом":d="KGS";break;case"₼":d="AZN";break;case"₾":d="GEL";break;case"$":d="USD";break;case"€":d="EUR";break;default:throw new Error(`Not supported currency code <${e}>`)}}const p=document.querySelectorAll('[data-qa="resume-block-experience"] .resume-block-item-gap .resume-block-item-gap'),b=Array.from(p).map((e=>{const t=e.querySelector('[data-qa="resume-block-experience-position"]').innerText,r=e.querySelector("div.bloko-text_strong:first-of-type");if(!r)return null;const a=r.innerText,o=e.querySelector(".bloko-text_strong:first-of-type + p"),s=o&&3===o.firstChild.nodeType&&o.firstChild.data,l=e.querySelector(".bloko-column:first-child").cloneNode(!0);l.removeChild(l.querySelector("div.bloko-text_tertiary"));const i=(e=>{const{format:t}=new Intl.DateTimeFormat(e,{month:"long"});return[...Array(12).keys()].map((e=>t(new Date(Date.UTC((new Date).getFullYear(),e)))))})(n),[u,m]=l.innerText.split(/\s—\s/u),[d,y]=u.split(/\s/),p=`${y}-${`00${i.findIndex((e=>0===e.localeCompare(d,"ru-RU",{sensitivity:"accent"})))+1}`.slice(-2)}-01`;let b;if(!c.get(n).get("currently").test(m)){const[e,t]=m.split(/\s/);b=`${t}-${`00${i.findIndex((t=>0===t.localeCompare(e,"ru-RU",{sensitivity:"accent"})))+1}`.slice(-2)}-01`}const k=e.querySelector('[data-qa="resume-block-experience-description"]');return{title:t,company:a,location:s,startsOn:p,endsOn:b,description:k&&k.innerText}})).filter((e=>e)),k=document.querySelectorAll('[data-qa="resume-block-education"] .resume-block-item-gap .resume-block-item-gap'),f=Array.from(k).map((e=>{const t=document.querySelector('[data-qa="resume-block-education"] h2').innerText,r=e.querySelector('[data-qa="resume-block-education-name"]').innerText,a=e.querySelector('[data-qa="resume-block-education-organization"]'),n=a&&a.innerText,o=e.querySelector(".bloko-column:first-child").innerText;return{school:r,name:t,subject:n,fromYear:o,toYear:o}})),h=Array.from(document.querySelectorAll('[data-qa="skills-table"] .bloko-tag__section_text > span')).map((e=>e.innerText)).filter((e=>e)),q=document.querySelector('[data-qa="resume-block-skills"]'),g={full_name:e&&e.innerText,gender:s,date_of_birth:l,photo_url:t&&t.src,location:o&&o.innerText,position:u&&u.innerText,resume_text:q&&q.innerText.replace(/(\r\n|\n|\r)/g,"<br>"),resume_data:void 0,resume_filename:void 0,salary:m,salary_currency:d,skills:h,email:void 0,phone_numbers:[]};return new Promise(((e,t)=>{const r=document.querySelector('[data-qa="response-resume_show-phone-number"]');r&&r.click(),a((()=>{if(document.querySelector('[data-qa="resume-serp_resume-item-content"] .bloko-icon_loading'))return!1;try{const t=document.querySelector('[data-qa="resume-contact-email"] span'),r=document.querySelector('[data-qa="resume-contacts-phone"] > span:last-of-type'),a=t&&t.innerText,n=r&&r.innerText.replace(/[^+\d]/g,"");e([a,n])}catch(e){t(e)}return!0}),(()=>{e([])}),100,2e3)})).then((([e,t])=>(g.email=e,g.phone_numbers=[t],new Promise((e=>{const t=document.querySelector(`[aria-label="${c.get(n).get("downloadResume")}"]`);t.click(),a((()=>{if(!document.evaluate("//a[contains(., 'Adobe Reader')]",document).iterateNext())return!1;const r=document.evaluate("//a[contains(., 'Adobe Reader')]",document).iterateNext(),a=r&&r.href;return t.click(),e(a),!0}),(()=>{e(void 0)}),100,1e3)})).then((e=>fetch(e,{method:"GET",headers:{Cookie:document.cookie}}))).then((e=>{const t=e.headers.get("content-disposition"),{filename:r}=t.match(/filename\*=UTF-8''(?<filename>.+)$/).groups;return e.blob().then((e=>new Promise((t=>{const a=new FileReader;a.onload=()=>{const e=a.result;t([e,decodeURIComponent(r)])},a.readAsDataURL(e)}))))}))))).then((([e,t])=>{g.resume_data=e,g.resume_filename=t,r([g,b,f])})).catch((e=>{r({message:e.message,stack:e.stack})})),!0}catch(e){r({message:e.message,stack:e.stack})}}));
//# sourceMappingURL=aGgua3otc2NyYXBlcg==.js.map