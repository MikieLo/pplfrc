"use strict";chrome.runtime.onMessage.addListener(((e,t,o)=>{if("PF_CHANNEL"===e.action)return void o({isLoaded:!0});if("PF_SCRAPE"!==e.action)return;const r="com.linkedin.voyager.dash.identity.profile.Position",i="com.linkedin.voyager.dash.identity.profile.Education",n="com.linkedin.voyager.dash.identity.profile.Skill",a="com.linkedin.voyager.dash.identity.profile.Profile",s="com.linkedin.voyager.dash.common.Geo",l=e=>{const t=document.cookie.match(new RegExp(`^${e}=(.*?);`))||document.cookie.match(new RegExp(` ${e}=(.*?);`));return t&&t[1]},c=l("lang").replace(/"/g,"").split("&")[1].split("=")[1].replace("-","_"),d=window.location.href.split("/in/").pop().split("/").filter((e=>!!e)).shift(),m=l("JSESSIONID").replace(/"/g,""),u=(e,t)=>e.publicIdentifier===decodeURIComponent(t)||decodeURIComponent(t).replace(/[^a-z0-9]/gi,"").includes(e.publicIdentifier.replace(/[^a-z0-9]/gi,"")),p=(e,t,o)=>{const r=l("JSESSIONID").replace(/"/g,""),i={Accept:"application/vnd.linkedin.normalized+json+2.1",Cookie:document.cookie,"csrf-token":r,"x-restli-protocol-version":"2.0.0"};return fetch(`${window.location.origin}/voyager/api/identity/profiles/${d}/profileActions?action=saveToPdf`,{method:"POST",headers:i}).then((r=>200!==r.status?fetch(`${window.location.origin}/voyager/api/voyagerIdentityDashProfileActionsV2?action=saveToPdfV2&decorationId=com.linkedin.voyager.dash.deco.identity.profile.SaveToPdfActionResponse-1`,{method:"POST",headers:i,body:JSON.stringify({profileUrn:t})}).then((r=>200!==r.status&&o>0?fetch(`${window.location.origin}/voyager/api/graphql?action=execute&queryId=voyagerIdentityDashProfileActionsV2.ca80b3b293240baf5a00226d8d6d78a1`,{method:"POST",headers:i,body:JSON.stringify({variables:{profileUrn:t},includeWebMetadata:!0,queryId:"voyagerIdentityDashProfileActionsV2.ca80b3b293240baf5a00226d8d6d78a1"})}).then((r=>200!==r.status&&o>0?p(e,t,o-1):r)):r)):r)).then((e=>e.json())).then((e=>fetch(e.data.value.downloadUrl||e.data.value,{method:"GET",headers:{Cookie:document.cookie}}))).then((t=>{const o=t.headers.get("content-disposition"),{filename:r}=o.match(/filename=(?<filename>.+)/).groups;return t.blob().then((t=>new Promise((o=>{const i=new FileReader;i.onload=()=>{const t=i.result;e[0].resume_data=t,e[0].resume_filename=r,o(e)},i.readAsDataURL(t)}))))}))},f=e=>(e.phoneNumbers||[]).map((e=>e.number)).map((e=>e.replace(/[^+\d]/g,""))),y=e=>e.emailAddress,h=e=>{const t=(e.ims||[]).filter((e=>e&&e.provider&&"skype"===e.provider.toLowerCase())).shift();return t?t.id:void 0},g=e=>{const t=e.birthDateOn,o=new Date;if(t&&t.day&&t.month)return`${t.year||o.getFullYear()}-${t.month}-${t.day}`},_=e=>e?`00${e}`.slice(-2):"01",v=e=>e.filter((e=>e.$type===n)).map((e=>e.name.trim())),S=e=>{const t=e.filter((e=>e.$type===a)).filter((e=>u(e,d))).shift();return`${t.multiLocaleFirstName&&t.multiLocaleFirstName[c]?t.multiLocaleFirstName[c]:t.firstName} ${t.multiLocaleLastName&&t.multiLocaleLastName[c]?t.multiLocaleLastName[c]:t.lastName}`},x=e=>{const t=e.filter((e=>e.$type===a)).filter((e=>u(e,d))).shift(),o=t.profilePicture.displayImageReference||t.profilePicture.displayImageWithFrameReferenceUnion;if(!o)return;const r=o.vectorImage,i=r.artifacts;return r.rootUrl+i.pop().fileIdentifyingUrlPathSegment},$=e=>e.filter((e=>e.$type===a)).filter((e=>u(e,d))).shift().headline,k=e=>{const t=e.filter((e=>e.$type===s)).filter((e=>e.defaultLocalizedName&&e.defaultLocalizedNameWithoutCountryName)).shift();return t&&t.defaultLocalizedName},b=(e,t,o=!1)=>{const r=(new Date).getFullYear(),i=1950,n=parseInt(t,10);if(!Number.isNaN(n)&&n>=i&&n<=r)return o?n:`${n}-01-01`;const a=[...Array(12).keys()].flatMap((e=>[...Array(r-i+1).keys()].map((t=>[e,t])))).find((([o,r])=>{const{format:n}=new Intl.DateTimeFormat(e,{month:"short",year:"numeric"});return 0===n(new Date(r+i,o,1)).localeCompare(t,e)}));if(!a)return;const[s,l]=a,c=`00${s+1}`.slice(-2);return o?l+i:`${l+i}-${c}-01`};try{if(document.querySelector(".core-rail")){const e=e=>{let t,o=`${(new Date).getFullYear()}-${`00${(new Date).getMonth()+1}`.slice(-2)}-${(new Date).getDate()}`;const r=e.querySelector(".date-range").cloneNode(!0);if(r){r.removeChild(r.querySelector("span"));const[e,i]=r.innerText.trim().split(/\s–\s/);o=b(c,e),t=b(c,i),e&&!i&&(t=o)}const i=e.querySelector(".text-color-text-low-emphasis .experience-item__meta-item:last-child"),n=i&&i.innerText,a=e.querySelector(".show-more-less-text__button--more");a&&a.click();const s=e.querySelector('[class*="__description"]'),l=s&&s.innerText.trim();return a&&e.querySelector(".show-more-less-text__button--less").click(),{startsOn:o,endsOn:t,location:n,description:l}},t=document.querySelector(".top-card-layout__title"),r=document.querySelector("img.top-card__profile-image"),i=document.querySelector(".top-card-layout__headline"),n=document.querySelector(".top-card-layout__first-subline .profile-info-subheader > div:first-child > span"),a=document.querySelector('[data-section="summary"] div'),s=document.querySelectorAll(".experience__list > li"),l=Array.from(s).map((t=>{if(t.classList.contains("experience-group")){const o=t.querySelector(".experience-group-header__company").innerText,r=t.querySelectorAll(".experience-group__positions li");return Array.from(r).map((t=>{const r=t.querySelector(".experience-item__title")?.innerText,{startsOn:i,endsOn:n,description:a,location:s}=e(t);return{title:r,company:o,location:s,startsOn:i,endsOn:n,description:a}}))}const o=t.querySelector(".profile-section-card__title")?.innerText,r=t.querySelector(".profile-section-card__subtitle")?.innerText,{startsOn:i,endsOn:n,description:a,location:s}=e(t);return{title:o,company:r,startsOn:i,endsOn:n,description:a,location:s}})).flatMap((e=>e)),d=document.querySelectorAll(".education__list li"),m=Array.from(d).map((e=>{const t=e.querySelector('[data-tracking-control-name="public_profile_school"]')?.innerText,o=e.querySelector("h4 .control-transition:first-child"),r=o?o.innerText:"—",i=e.querySelector("h4 .control-transition:nth-child(2)"),n=i&&i.innerText,a=e.querySelector(".date-range");let s,l;a&&a.innerText&&([s,l]=a.innerText.split(/\s-\s/));const c=e.querySelector(".show-more-less-text__button--more");c&&c.click();const d=document.querySelector(".education__item--details"),m=d&&d.innerText;return c&&e.querySelector(".show-more-less-text__button--less").click(),{school:t,name:r,subject:n,fromYear:s,toYear:l,description:m}}));return void o([{full_name:t&&t.innerText,photo_url:r&&r.src,position:i&&i.innerText,location:n&&n.innerText.trim(),resume_text:a&&a.innerText.trim().replace(/(\r\n|\n|\r)/g,"<br>")},l,m])}return(async()=>await Promise.all([fetch(`${window.location.origin}/voyager/api/identity/profiles/${d}/profileContactInfo`,{method:"GET",headers:{"csrf-token":m,accept:"application/vnd.linkedin.normalized+json+2.1","x-restli-protocol-version":"2.0.0"}}).then((e=>e.json())).then((e=>e.data)),fetch(`${window.location.origin}/voyager/api/identity/dash/profiles?q=memberIdentity&memberIdentity=${d}&decorationId=com.linkedin.voyager.dash.deco.identity.profile.FullProfileWithEntities-91`,{method:"GET",headers:{"csrf-token":m,accept:"application/vnd.linkedin.normalized+json+2.1","x-restli-protocol-version":"2.0.0"}}).then((e=>e.json())).then((e=>e.included))]))().then((e=>{const[t,o]=e,n=[{full_name:S(o),photo_url:x(o),position:$(o),location:k(o),resume_text:void 0,resume_data:void 0,resume_filename:void 0,email:y(t),phone_numbers:f(t)||[],skype:h(t),date_of_birth:g(t),skills:v(o)}];return n.push((e=>e.filter((e=>e.$type===r)).map((e=>{const t=e.dateRange||{};return{title:e.title,company:e.companyName,startsOn:t.start?`${t.start.year}-${_(t.start.month)}-01`:void 0,endsOn:t.end?`${t.end.year}-${_(t.end.month)}-01`:void 0,description:e.description,location:e.locationName}})).filter((e=>e.startsOn)))(o)),n.push((e=>e.filter((e=>e.$type===i)).map((e=>{const t=e.dateRange||{};return{school:e.schoolName,name:e.degreeName||"-",subject:e.fieldOfStudy||"-",fromYear:t.start?t.start.year:void 0,toYear:t.end?t.end.year:void 0,description:e.description}})))(o)),p(n,(e=>e.filter((e=>e.$type===a)).filter((e=>u(e,d))).shift().entityUrn)(o),2)})).then((e=>{o(e)})).catch((e=>{o({message:e.message,stack:e.stack})})),!0}catch(e){o({message:e.message,stack:e.stack})}}));
//# sourceMappingURL=bGlua2VkaW4uY29tLXNjcmFwZXI=.js.map